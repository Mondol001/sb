<!DOCTYPE html>
<html lang="bn">
<head>
  <!-- পূর্বের স্টাইল -->
</head>
<body>
  <div class="container">
    <div class="header-section">
      <h1 class="text-center mb-4 text-primary">
        <i class="fas fa-clipboard-list"></i> আমার হাজিরা রিপোর্ট
      </h1>
      <div class="text-end">
        <button class="btn btn-danger btn-sm" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i> লগআউট
        </button>
      </div>
    </div>
    
    <!-- মাসিক ডাটা টেবিল -->
    <div class="monthly-table">
      <h2 class="mb-3">হাজিরা সারাংশ</h2>
      <div class="table-responsive">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th>তারিখ</th>
              <th>হাজিরা</th>
              <th>ওভারটাইম</th>
            </tr>
          </thead>
          <tbody id="attendanceData"></tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // Firebase অথেন্টিকেশন
    auth.onAuthStateChanged(async (user) => {
      if (!user) window.location.href = 'login.html';
      
      // শুধুমাত্র নিজের ডাটা লোড
      const doc = await db.collection('employees').doc(user.uid).get();
      if (doc.exists) {
        document.getElementById('employeeName').textContent = doc.data().name;
        loadAttendanceData(user.uid);
      }
    });

    async function loadAttendanceData(userId) {
      const snapshot = await db.collection('employees')
        .doc(userId)
        .collection('attendance')
        .orderBy('date', 'desc')
        .get();

      const tbody = document.getElementById('attendanceData');
      tbody.innerHTML = '';
      
      snapshot.forEach(doc => {
        const data = doc.data();
        const row = `
          <tr>
            <td>${data.date.toDate().toLocaleDateString('bn-BD')}</td>
            <td>${data.status === 'present' ? 'উপস্থিত' : 'অনুপস্থিত'}</td>
            <td>${data.overtime} ঘণ্টা</td>
          </tr>
        `;
        tbody.innerHTML += row;
      });
    }

    // লগআউট
    document.getElementById('logoutBtn').addEventListener('click', () => {
      auth.signOut().then(() => {
        window.location.href = 'login.html';
      });
    });
  </script>
</body>
</html>
